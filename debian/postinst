#!/bin/bash

set -e

case "$1" in
    configure)
        # Update desktop database
        if command -v update-desktop-database >/dev/null 2>&1; then
            update-desktop-database -q /usr/share/applications || true
        fi
        
        # Update icon cache
        if command -v gtk-update-icon-cache >/dev/null 2>&1; then
            gtk-update-icon-cache -q /usr/share/pixmaps || true
        fi
        
        # Update MIME database
        if command -v update-mime-database >/dev/null 2>&1; then
            update-mime-database /usr/share/mime || true
        fi
        
        echo "Loom text editor v1.2.1 installed successfully!"
        echo "Run 'loom' to start the editor."
        echo ""
        echo "New in v1.2.1:"
        echo "  • File tree viewer with collapsible directory navigation"
        echo "  • Project support: Open entire projects with ./loom project-folder"
        echo "  • File tree panel with F12 toggle shortcut"
        echo "  • Context menu for file operations (new, rename, delete)"
        echo "  • Single-click file opening from file tree"
        echo "  • Multiple themes: Gruvbox, Dracula, Catppuccin Mocha"
        echo "  • Theme switching: Press Ctrl+Shift+T or use Tools menu"
        echo "  • Enhanced plugin system with dynamic menus"
        echo ""
        echo "Note: For AutoFormat plugin functionality, install formatters:"
        echo "  sudo apt install clang-format nodejs npm python3-pip"
        echo "  npm install -g prettier"
        echo "  pip3 install black"
        echo "  cargo install stylua  # if you have Rust installed"
        ;;
esac

#DEBHELPER#

exit 0
